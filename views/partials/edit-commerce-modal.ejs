<!-- Modal -->
<div class="modal fade" id="edit-commerce-modal" role="dialog" aria-labelledby="edit-commerceLabel">
    <div class="modal-dialog" role="document">
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title" id="edit-commerceLabel">Editar Comercio</h4>
        </div>
        <div class="modal-body">            
            <form action="" method="put" class="editCommerce" name="form-edit-commerce" id="editForm">
                <input type="hidden" class="form-control" name="id">
                
                <label for="code">Codigo</label>
                <input class="form-control" type="text" name="code" maxlength="12" required >
                <div class="help-block with-errors"></div>
                
                <label for="name">Nombre</label>
                <input class="form-control" type="text" name="name" required>
                <div class="help-block with-errors"></div>
                
                <label for="description">Descripcion</label>
                <input class="form-control" type="text" name="description">
                <div class="help-block with-errors"></div>
                
                <label for="latitude">Latitud</label>
                <input class="form-control" type="number" name="latitude" max="90" min="-90" required>
                <div class="help-block with-errors"></div>
                
                <label for="longitude">Longitud</label>
                <input class="form-control" type="number" name="longitude" max="180" min="-180" required>
                <div class="help-block with-errors"></div>
                
                <br>
                
                <button type="submit" class="btn btn-primary">Guardar</button>
            </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal" onClick="saveModifiedCommerce()">Cancelar</button>
        </div>
      </div>
    </div>
</div>

<script>
$(document).ready(function() {
    $('.editButton').on('click', function() {
        // Get the record's ID via attribute
        var id = $(this).attr('data-id');
                
        $.ajax({
            url: 'http://localhost:2728/commerce/' + id,
            method: 'GET'
        }).success(function(response) {
            // Populate the form fields with the data returned from server
            $('#edit-commerce-modal')
                .find('[name="id"]').val(response.id).end()
                .find('[name="code"]').val(response.code).end()
                .find('[name="name"]').val(response.name).end()
                .find('[name="description"]').val(response.description).end()
                .find('[name="latitude"]').val(response.latitude).end()
                .find('[name="longitude"]').val(response.longitude).end();
        });
    });
    
    function saveModifiedCommerce(){
        var $form = $(this),
            id    = $form.find('[name="id"]').val(),
            $inputs = $form.find("input, button");
        
        $.ajax({
            url: 'commerce/edit' + id,
            type: 'put',
            data: $('#editForm').serialize(),
            success: function (res) {
                console.log(res);
                return false;
            },
            error: function (xhr, status, error) {
                console.log(xhr.responseText);
                return true;
            }
        });
    }
</script>